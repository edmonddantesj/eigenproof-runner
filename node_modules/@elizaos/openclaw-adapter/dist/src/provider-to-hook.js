import { buildMemory } from "./memory-builder.js";
export function adaptProviderToHook(provider, bridge) {
    return {
        hookName: "before_agent_start",
        providerName: provider.name,
        async handler(event) {
            const promptText = typeof event.prompt === "string" ? event.prompt : "";
            const message = buildMemory({ text: promptText, agentId: bridge.agentId });
            const state = { values: { agentName: bridge.character.name ?? "Eliza" }, data: {}, text: promptText };
            let result;
            try {
                result = await provider.get(bridge, message, state);
            }
            catch (err) {
                bridge.logger.warn(`[eliza-adapter] Provider "${provider.name}" failed: ${err instanceof Error ? err.message : String(err)}`);
                return;
            }
            if (result?.text?.trim()) {
                return { prependContext: `<eliza-provider name="${provider.name}">\n${result.text}\n</eliza-provider>` };
            }
        },
    };
}
//# sourceMappingURL=provider-to-hook.js.map