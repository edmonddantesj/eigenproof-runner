{
  "version": "0.1.0",
  "name": "solana_sentinel",
  "instructions": [
    {
      "name": "advance_epoch",
      "accounts": [
        {
          "name": "vault",
          "isMut": true,
          "isSigner": false
        },
        {
          "name": "authority",
          "isMut": false,
          "isSigner": true
        }
      ],
      "args": [],
      "docs": [
        "Authority advances the vault epoch. Resets epoch_profit counter.",
        "Useful for periodic reporting and agent performance snapshots."
      ]
    },
    {
      "name": "claim_agent_reward",
      "accounts": [
        {
          "name": "vault",
          "isMut": false,
          "isSigner": false
        },
        {
          "name": "vault_sol",
          "isMut": true,
          "isSigner": false
        },
        {
          "name": "agent_profile",
          "isMut": true,
          "isSigner": false
        },
        {
          "name": "agent",
          "isMut": true,
          "isSigner": true
        },
        {
          "name": "system_program",
          "isMut": false,
          "isSigner": false
        }
      ],
      "args": [],
      "docs": [
        "Agent claims their accumulated performance rewards from the vault.",
        "Resets total_rewards_earned to 0 after claim."
      ]
    },
    {
      "name": "deactivate_agent",
      "accounts": [
        {
          "name": "vault",
          "isMut": false,
          "isSigner": false
        },
        {
          "name": "agent_profile",
          "isMut": true,
          "isSigner": false
        },
        {
          "name": "authority",
          "isMut": false,
          "isSigner": true
        }
      ],
      "args": [],
      "docs": [
        "Authority deactivates an agent. Does not delete the PDA (preserves history)."
      ]
    },
    {
      "name": "deposit",
      "accounts": [
        {
          "name": "vault",
          "isMut": true,
          "isSigner": false
        },
        {
          "name": "vault_sol",
          "isMut": true,
          "isSigner": false
        },
        {
          "name": "user_position",
          "isMut": true,
          "isSigner": false
        },
        {
          "name": "user",
          "isMut": true,
          "isSigner": true
        },
        {
          "name": "system_program",
          "isMut": false,
          "isSigner": false
        }
      ],
      "args": [
        {
          "name": "amount",
          "type": "u64"
        }
      ],
      "docs": [
        "Deposits SOL into the vault. Mints shares at current NAV.",
        "",
        "Math:",
        "NAV/share = vault_balance / total_shares",
        "shares_minted = amount / (NAV/share) = amount * total_shares / vault_balance",
        "",
        "First deposit: 1 lamport = 1 share (NAV = 1.0)."
      ]
    },
    {
      "name": "distribute_profits",
      "accounts": [
        {
          "name": "vault",
          "isMut": true,
          "isSigner": false
        },
        {
          "name": "vault_sol",
          "isMut": true,
          "isSigner": false
        },
        {
          "name": "agent_profile",
          "isMut": true,
          "isSigner": false
        },
        {
          "name": "oracle",
          "isMut": true,
          "isSigner": true
        },
        {
          "name": "system_program",
          "isMut": false,
          "isSigner": false
        }
      ],
      "args": [
        {
          "name": "amount",
          "type": "u64"
        },
        {
          "name": "agent_fee_bps",
          "type": "u16"
        }
      ],
      "docs": [
        "Distributes profits into the vault, increasing NAV/share for all holders.",
        "The oracle sends SOL to the vault; the vault tracks which agent generated",
        "the profit and increases that agent's reward counter.",
        "",
        "Architecture note: Profit goes into the shared vault (benefiting all depositors",
        "via NAV appreciation). A configurable agent_fee_bps is carved out and tracked",
        "in the agent's total_rewards_earned for later claim.",
        "",
        "Formula for agent fee carve-out:",
        "agent_reward = (amount * agent_fee_bps) / 10_000",
        "vault_portion = amount - agent_reward",
        "",
        "The agent_reward stays in the vault but is earmarked for the agent.",
        "The vault_portion increases NAV/share for all depositors."
      ]
    },
    {
      "name": "emergency_stop",
      "accounts": [
        {
          "name": "vault",
          "isMut": true,
          "isSigner": false
        },
        {
          "name": "guardian",
          "isMut": false,
          "isSigner": true
        }
      ],
      "args": [
        {
          "name": "pause",
          "type": "bool"
        }
      ],
      "docs": [
        "Guardian can pause/unpause the vault in case of detected risk."
      ]
    },
    {
      "name": "initialize",
      "accounts": [
        {
          "name": "vault",
          "isMut": true,
          "isSigner": false
        },
        {
          "name": "vault_sol",
          "isMut": true,
          "isSigner": false
        },
        {
          "name": "authority",
          "isMut": true,
          "isSigner": true
        },
        {
          "name": "system_program",
          "isMut": false,
          "isSigner": false
        }
      ],
      "args": [
        {
          "name": "guardian",
          "type": "publicKey"
        },
        {
          "name": "oracle",
          "type": "publicKey"
        },
        {
          "name": "daily_withdraw_cap",
          "type": "u64"
        },
        {
          "name": "cooldown_seconds",
          "type": "i64"
        }
      ],
      "docs": [
        "Initialize the vault with authority, guardian, oracle, and policy params."
      ]
    },
    {
      "name": "query_agent_score",
      "accounts": [
        {
          "name": "vault",
          "isMut": false,
          "isSigner": false
        },
        {
          "name": "agent_profile",
          "isMut": false,
          "isSigner": false
        }
      ],
      "args": [],
      "docs": [
        "Computes and emits the agent's on-chain Sharpe-like score.",
        "",
        "Math (all in basis points, integer arithmetic):",
        "n     = trade_count",
        "\u03bc     = sum_returns / n                    (mean return in bps)",
        "\u03c3\u00b2    = (sum_sq_returns / n) - \u03bc\u00b2          (variance in bps\u00b2)",
        "score = \u03bc\u00b2 * SCORE_PRECISION / \u03c3\u00b2          (Sharpe\u00b2 * precision)",
        "",
        "We emit score_numerator = \u03bc\u00b2 and score_denominator = \u03c3\u00b2 so the client",
        "can compute the exact ratio. If \u03c3\u00b2 = 0 and \u03bc > 0, agent has perfect",
        "consistency \u2192 score = MAX_SCORE sentinel value.",
        "",
        "Win rate is also emitted: win_rate_bps = (winning_trades * 10000) / trade_count"
      ]
    },
    {
      "name": "register_agent",
      "accounts": [
        {
          "name": "vault",
          "isMut": true,
          "isSigner": false
        },
        {
          "name": "agent_profile",
          "isMut": true,
          "isSigner": false
        },
        {
          "name": "authority",
          "isMut": true,
          "isSigner": true
        },
        {
          "name": "system_program",
          "isMut": false,
          "isSigner": false
        }
      ],
      "args": [
        {
          "name": "agent_key",
          "type": "publicKey"
        }
      ],
      "docs": [
        "Authority registers a new agent that can earn rewards from the vault.",
        "Creates an AgentProfile PDA seeded by [b\"agent\", vault, agent_pubkey]."
      ]
    },
    {
      "name": "report_trade",
      "accounts": [
        {
          "name": "vault",
          "isMut": false,
          "isSigner": false
        },
        {
          "name": "agent_profile",
          "isMut": true,
          "isSigner": false
        },
        {
          "name": "oracle",
          "isMut": false,
          "isSigner": true
        }
      ],
      "args": [
        {
          "name": "pnl_bps",
          "type": "i64"
        },
        {
          "name": "is_win",
          "type": "bool"
        }
      ],
      "docs": [
        "Oracle reports a single trade result for an agent.",
        "",
        "Parameters:",
        "pnl_bps: signed basis points (1 bp = 0.01%). E.g., +150 = +1.50%.",
        "Allows negative values to penalize losing trades.",
        "is_win:  whether this trade was profitable (for win-rate tracking).",
        "",
        "On-chain statistics updated:",
        "trade_count += 1",
        "winning_trades += is_win ? 1 : 0",
        "cumulative_pnl += pnl_bps",
        "sum_returns += pnl_bps         (for mean calculation)",
        "sum_sq_returns += pnl_bps\u00b2     (for variance calculation)",
        "",
        "These enable the Sharpe-like scoring:",
        "mean = sum_returns / trade_count",
        "var  = (sum_sq_returns / trade_count) - mean\u00b2",
        "score\u00b2 = mean\u00b2 / var   (used directly for weight calculation)"
      ]
    },
    {
      "name": "set_whitelist",
      "accounts": [
        {
          "name": "vault",
          "isMut": false,
          "isSigner": false
        },
        {
          "name": "user_position",
          "isMut": true,
          "isSigner": false
        },
        {
          "name": "user",
          "isMut": false,
          "isSigner": true
        }
      ],
      "args": [
        {
          "name": "destinations",
          "type": {
            "vec": "publicKey"
          }
        }
      ],
      "docs": [
        "User sets their own whitelisted withdrawal destinations.",
        "Up to MAX_WHITELIST (4) addresses. When set, withdrawals can only",
        "go to self or one of these addresses."
      ]
    },
    {
      "name": "update_policy",
      "accounts": [
        {
          "name": "vault",
          "isMut": true,
          "isSigner": false
        },
        {
          "name": "guardian",
          "isMut": false,
          "isSigner": true
        }
      ],
      "args": [
        {
          "name": "new_daily_cap",
          "type": "u64"
        },
        {
          "name": "new_cooldown_seconds",
          "type": "i64"
        }
      ],
      "docs": [
        "Guardian updates policy parameters (daily cap, cooldown)."
      ]
    },
    {
      "name": "update_roles",
      "accounts": [
        {
          "name": "vault",
          "isMut": true,
          "isSigner": false
        },
        {
          "name": "authority",
          "isMut": false,
          "isSigner": true
        }
      ],
      "args": [
        {
          "name": "new_guardian",
          "type": {
            "option": "publicKey"
          }
        },
        {
          "name": "new_oracle",
          "type": {
            "option": "publicKey"
          }
        }
      ],
      "docs": [
        "Authority can update guardian or oracle addresses."
      ]
    },
    {
      "name": "withdraw",
      "accounts": [
        {
          "name": "vault",
          "isMut": true,
          "isSigner": false
        },
        {
          "name": "vault_sol",
          "isMut": true,
          "isSigner": false
        },
        {
          "name": "user_position",
          "isMut": true,
          "isSigner": false
        },
        {
          "name": "owner",
          "isMut": true,
          "isSigner": false
        },
        {
          "name": "user",
          "isMut": true,
          "isSigner": true
        },
        {
          "name": "system_program",
          "isMut": false,
          "isSigner": false
        }
      ],
      "args": [
        {
          "name": "shares_to_burn",
          "type": "u64"
        }
      ],
      "docs": [
        "Burns shares and returns SOL. Enforces:",
        "1. Cooldown: last_withdraw_ts + cooldown_seconds <= now",
        "2. Daily cap: daily_withdrawn + withdraw_amount <= daily_withdraw_cap",
        "(daily counter resets each UTC day = unix_ts / 86400)",
        "3. Whitelist: if user has whitelisted destinations, the `user` (recipient)",
        "must match one of them. (Self-withdraw always allowed.)",
        "",
        "Withdraw math:",
        "sol_returned = shares_burned * vault_balance / total_shares"
      ]
    }
  ],
  "accounts": [
    {
      "name": "AgentProfile",
      "type": {
        "kind": "struct",
        "fields": [
          {
            "name": "agent",
            "type": "publicKey",
            "docs": [
              "Public key of the agent"
            ]
          },
          {
            "name": "vault",
            "type": "publicKey",
            "docs": [
              "Vault this agent operates for"
            ]
          },
          {
            "name": "trade_count",
            "type": "u32",
            "docs": [
              "Total number of trades reported"
            ]
          },
          {
            "name": "winning_trades",
            "type": "u32",
            "docs": [
              "Number of winning trades (for win-rate calculation)"
            ]
          },
          {
            "name": "cumulative_pnl",
            "type": "i64",
            "docs": [
              "Cumulative PnL in basis points (signed)"
            ]
          },
          {
            "name": "sum_returns",
            "type": "i128",
            "docs": [
              "\u03a3(return_i) \u2014 sum of all individual trade returns (bps, signed)",
              "Used for mean calculation: \u03bc = sum_returns / trade_count"
            ]
          },
          {
            "name": "sum_sq_returns",
            "type": "u128",
            "docs": [
              "\u03a3(return_i\u00b2) \u2014 sum of squared returns (always non-negative)",
              "Used for variance: \u03c3\u00b2 = sum_sq_returns/n - (sum_returns/n)\u00b2"
            ]
          },
          {
            "name": "total_rewards_earned",
            "type": "u64",
            "docs": [
              "Accumulated rewards earmarked for this agent (lamports)"
            ]
          },
          {
            "name": "last_report_ts",
            "type": "i64",
            "docs": [
              "Timestamp of last trade report"
            ]
          },
          {
            "name": "is_active",
            "type": "bool",
            "docs": [
              "Whether the agent is actively receiving reports"
            ]
          }
        ]
      }
    },
    {
      "name": "UserPosition",
      "type": {
        "kind": "struct",
        "fields": [
          {
            "name": "owner",
            "type": "publicKey",
            "docs": [
              "Owner of this position"
            ]
          },
          {
            "name": "vault",
            "type": "publicKey",
            "docs": [
              "Vault this position belongs to"
            ]
          },
          {
            "name": "shares",
            "type": "u64",
            "docs": [
              "Number of shares held"
            ]
          },
          {
            "name": "total_deposited",
            "type": "u64",
            "docs": [
              "Cumulative SOL deposited"
            ]
          },
          {
            "name": "total_withdrawn",
            "type": "u64",
            "docs": [
              "Cumulative SOL withdrawn"
            ]
          },
          {
            "name": "last_action_ts",
            "type": "i64",
            "docs": [
              "Last action timestamp"
            ]
          },
          {
            "name": "last_withdraw_ts",
            "type": "i64",
            "docs": [
              "Timestamp of last withdrawal (for cooldown enforcement)"
            ]
          },
          {
            "name": "last_withdraw_day",
            "type": "i64",
            "docs": [
              "UTC day number of last withdrawal (for daily cap reset)"
            ]
          },
          {
            "name": "daily_withdrawn",
            "type": "u64",
            "docs": [
              "Lamports withdrawn so far today"
            ]
          },
          {
            "name": "whitelist",
            "type": {
              "array": [
                "publicKey",
                4
              ]
            },
            "docs": [
              "Whitelisted withdrawal destinations (Pubkey::default = unused slot)"
            ]
          },
          {
            "name": "whitelist_count",
            "type": "u8",
            "docs": [
              "Number of active whitelist entries (0 = no restriction)"
            ]
          }
        ]
      }
    },
    {
      "name": "Vault",
      "type": {
        "kind": "struct",
        "fields": [
          {
            "name": "authority",
            "type": "publicKey",
            "docs": [
              "The authority that created and controls the vault"
            ]
          },
          {
            "name": "guardian",
            "type": "publicKey",
            "docs": [
              "Risk guardian who can trigger emergency stop & update policy"
            ]
          },
          {
            "name": "oracle",
            "type": "publicKey",
            "docs": [
              "Alpha Oracle authorized to distribute profits & report trades"
            ]
          },
          {
            "name": "total_shares",
            "type": "u64",
            "docs": [
              "Total outstanding share tokens (denominator for NAV calc)"
            ]
          },
          {
            "name": "total_deposited",
            "type": "u64",
            "docs": [
              "Cumulative SOL deposited (lifetime tracking metric)"
            ]
          },
          {
            "name": "total_profits_distributed",
            "type": "u64",
            "docs": [
              "Cumulative profits distributed (lifetime tracking metric)"
            ]
          },
          {
            "name": "is_paused",
            "type": "bool",
            "docs": [
              "Emergency pause flag"
            ]
          },
          {
            "name": "bump",
            "type": "u8",
            "docs": [
              "PDA bump for vault account"
            ]
          },
          {
            "name": "vault_sol_bump",
            "type": "u8",
            "docs": [
              "PDA bump for vault SOL holder"
            ]
          },
          {
            "name": "daily_withdraw_cap",
            "type": "u64",
            "docs": [
              "Maximum lamports a user can withdraw per UTC day (0 = unlimited)"
            ]
          },
          {
            "name": "cooldown_seconds",
            "type": "i64",
            "docs": [
              "Minimum seconds between withdrawals per user (0 = no cooldown)"
            ]
          },
          {
            "name": "epoch",
            "type": "u64",
            "docs": [
              "Current epoch number (incremented by authority)"
            ]
          },
          {
            "name": "epoch_profit",
            "type": "u64",
            "docs": [
              "Profit accumulated in current epoch (resets on advance)"
            ]
          },
          {
            "name": "agent_count",
            "type": "u32",
            "docs": [
              "Number of registered agents"
            ]
          }
        ]
      }
    }
  ],
  "types": [
    {
      "name": "AgentDeactivated",
      "type": {
        "kind": "struct",
        "fields": [
          {
            "name": "vault",
            "type": "publicKey"
          },
          {
            "name": "agent",
            "type": "publicKey"
          }
        ]
      }
    },
    {
      "name": "AgentRegistered",
      "type": {
        "kind": "struct",
        "fields": [
          {
            "name": "vault",
            "type": "publicKey"
          },
          {
            "name": "agent",
            "type": "publicKey"
          }
        ]
      }
    },
    {
      "name": "AgentRewardClaimed",
      "type": {
        "kind": "struct",
        "fields": [
          {
            "name": "agent",
            "type": "publicKey"
          },
          {
            "name": "amount",
            "type": "u64"
          }
        ]
      }
    },
    {
      "name": "AgentScoreComputed",
      "type": {
        "kind": "struct",
        "fields": [
          {
            "name": "agent",
            "type": "publicKey"
          },
          {
            "name": "trade_count",
            "type": "u32"
          },
          {
            "name": "win_rate_bps",
            "type": "u64"
          },
          {
            "name": "cumulative_pnl",
            "type": "i64"
          },
          {
            "name": "score_numerator",
            "type": "u128",
            "docs": [
              "\u03bc\u00b2 (mean return squared) \u2014 numerator of Sharpe\u00b2"
            ]
          },
          {
            "name": "score_denominator",
            "type": "u128",
            "docs": [
              "\u03c3\u00b2 (variance) \u2014 denominator of Sharpe\u00b2"
            ]
          },
          {
            "name": "mean_positive",
            "type": "bool",
            "docs": [
              "Whether mean return is non-negative"
            ]
          }
        ]
      }
    },
    {
      "name": "Deposited",
      "type": {
        "kind": "struct",
        "fields": [
          {
            "name": "user",
            "type": "publicKey"
          },
          {
            "name": "amount",
            "type": "u64"
          },
          {
            "name": "shares_minted",
            "type": "u64"
          },
          {
            "name": "total_vault_shares",
            "type": "u64"
          }
        ]
      }
    },
    {
      "name": "EmergencyAction",
      "type": {
        "kind": "struct",
        "fields": [
          {
            "name": "guardian",
            "type": "publicKey"
          },
          {
            "name": "paused",
            "type": "bool"
          },
          {
            "name": "timestamp",
            "type": "i64"
          }
        ]
      }
    },
    {
      "name": "EpochAdvanced",
      "type": {
        "kind": "struct",
        "fields": [
          {
            "name": "vault",
            "type": "publicKey"
          },
          {
            "name": "previous_epoch",
            "type": "u64"
          },
          {
            "name": "new_epoch",
            "type": "u64"
          },
          {
            "name": "epoch_profit",
            "type": "u64"
          }
        ]
      }
    },
    {
      "name": "PolicyUpdated",
      "type": {
        "kind": "struct",
        "fields": [
          {
            "name": "guardian",
            "type": "publicKey"
          },
          {
            "name": "daily_withdraw_cap",
            "type": "u64"
          },
          {
            "name": "cooldown_seconds",
            "type": "i64"
          }
        ]
      }
    },
    {
      "name": "ProfitsDistributed",
      "type": {
        "kind": "struct",
        "fields": [
          {
            "name": "oracle",
            "type": "publicKey"
          },
          {
            "name": "amount",
            "type": "u64"
          },
          {
            "name": "agent_reward",
            "type": "u64"
          },
          {
            "name": "total_vault_balance",
            "type": "u64"
          },
          {
            "name": "total_profits_distributed",
            "type": "u64"
          }
        ]
      }
    },
    {
      "name": "RolesUpdated",
      "type": {
        "kind": "struct",
        "fields": [
          {
            "name": "authority",
            "type": "publicKey"
          },
          {
            "name": "guardian",
            "type": "publicKey"
          },
          {
            "name": "oracle",
            "type": "publicKey"
          }
        ]
      }
    },
    {
      "name": "TradeReported",
      "type": {
        "kind": "struct",
        "fields": [
          {
            "name": "agent",
            "type": "publicKey"
          },
          {
            "name": "pnl_bps",
            "type": "i64"
          },
          {
            "name": "is_win",
            "type": "bool"
          },
          {
            "name": "trade_count",
            "type": "u32"
          },
          {
            "name": "cumulative_pnl",
            "type": "i64"
          }
        ]
      }
    },
    {
      "name": "VaultInitialized",
      "type": {
        "kind": "struct",
        "fields": [
          {
            "name": "authority",
            "type": "publicKey"
          },
          {
            "name": "guardian",
            "type": "publicKey"
          },
          {
            "name": "oracle",
            "type": "publicKey"
          },
          {
            "name": "daily_withdraw_cap",
            "type": "u64"
          },
          {
            "name": "cooldown_seconds",
            "type": "i64"
          }
        ]
      }
    },
    {
      "name": "WhitelistUpdated",
      "type": {
        "kind": "struct",
        "fields": [
          {
            "name": "user",
            "type": "publicKey"
          },
          {
            "name": "count",
            "type": "u8"
          }
        ]
      }
    },
    {
      "name": "Withdrawn",
      "type": {
        "kind": "struct",
        "fields": [
          {
            "name": "user",
            "type": "publicKey"
          },
          {
            "name": "shares_burned",
            "type": "u64"
          },
          {
            "name": "amount_returned",
            "type": "u64"
          },
          {
            "name": "total_vault_shares",
            "type": "u64"
          }
        ]
      }
    }
  ],
  "events": [
    {
      "name": "AgentDeactivated",
      "fields": [
        {
          "name": "vault",
          "type": "publicKey"
        },
        {
          "name": "agent",
          "type": "publicKey"
        }
      ]
    },
    {
      "name": "AgentRegistered",
      "fields": [
        {
          "name": "vault",
          "type": "publicKey"
        },
        {
          "name": "agent",
          "type": "publicKey"
        }
      ]
    },
    {
      "name": "AgentRewardClaimed",
      "fields": [
        {
          "name": "agent",
          "type": "publicKey"
        },
        {
          "name": "amount",
          "type": "u64"
        }
      ]
    },
    {
      "name": "AgentScoreComputed",
      "fields": [
        {
          "name": "agent",
          "type": "publicKey"
        },
        {
          "name": "trade_count",
          "type": "u32"
        },
        {
          "name": "win_rate_bps",
          "type": "u64"
        },
        {
          "name": "cumulative_pnl",
          "type": "i64"
        },
        {
          "name": "score_numerator",
          "type": "u128",
          "docs": [
            "\u03bc\u00b2 (mean return squared) \u2014 numerator of Sharpe\u00b2"
          ]
        },
        {
          "name": "score_denominator",
          "type": "u128",
          "docs": [
            "\u03c3\u00b2 (variance) \u2014 denominator of Sharpe\u00b2"
          ]
        },
        {
          "name": "mean_positive",
          "type": "bool",
          "docs": [
            "Whether mean return is non-negative"
          ]
        }
      ]
    },
    {
      "name": "Deposited",
      "fields": [
        {
          "name": "user",
          "type": "publicKey"
        },
        {
          "name": "amount",
          "type": "u64"
        },
        {
          "name": "shares_minted",
          "type": "u64"
        },
        {
          "name": "total_vault_shares",
          "type": "u64"
        }
      ]
    },
    {
      "name": "EmergencyAction",
      "fields": [
        {
          "name": "guardian",
          "type": "publicKey"
        },
        {
          "name": "paused",
          "type": "bool"
        },
        {
          "name": "timestamp",
          "type": "i64"
        }
      ]
    },
    {
      "name": "EpochAdvanced",
      "fields": [
        {
          "name": "vault",
          "type": "publicKey"
        },
        {
          "name": "previous_epoch",
          "type": "u64"
        },
        {
          "name": "new_epoch",
          "type": "u64"
        },
        {
          "name": "epoch_profit",
          "type": "u64"
        }
      ]
    },
    {
      "name": "PolicyUpdated",
      "fields": [
        {
          "name": "guardian",
          "type": "publicKey"
        },
        {
          "name": "daily_withdraw_cap",
          "type": "u64"
        },
        {
          "name": "cooldown_seconds",
          "type": "i64"
        }
      ]
    },
    {
      "name": "ProfitsDistributed",
      "fields": [
        {
          "name": "oracle",
          "type": "publicKey"
        },
        {
          "name": "amount",
          "type": "u64"
        },
        {
          "name": "agent_reward",
          "type": "u64"
        },
        {
          "name": "total_vault_balance",
          "type": "u64"
        },
        {
          "name": "total_profits_distributed",
          "type": "u64"
        }
      ]
    },
    {
      "name": "RolesUpdated",
      "fields": [
        {
          "name": "authority",
          "type": "publicKey"
        },
        {
          "name": "guardian",
          "type": "publicKey"
        },
        {
          "name": "oracle",
          "type": "publicKey"
        }
      ]
    },
    {
      "name": "TradeReported",
      "fields": [
        {
          "name": "agent",
          "type": "publicKey"
        },
        {
          "name": "pnl_bps",
          "type": "i64"
        },
        {
          "name": "is_win",
          "type": "bool"
        },
        {
          "name": "trade_count",
          "type": "u32"
        },
        {
          "name": "cumulative_pnl",
          "type": "i64"
        }
      ]
    },
    {
      "name": "VaultInitialized",
      "fields": [
        {
          "name": "authority",
          "type": "publicKey"
        },
        {
          "name": "guardian",
          "type": "publicKey"
        },
        {
          "name": "oracle",
          "type": "publicKey"
        },
        {
          "name": "daily_withdraw_cap",
          "type": "u64"
        },
        {
          "name": "cooldown_seconds",
          "type": "i64"
        }
      ]
    },
    {
      "name": "WhitelistUpdated",
      "fields": [
        {
          "name": "user",
          "type": "publicKey"
        },
        {
          "name": "count",
          "type": "u8"
        }
      ]
    },
    {
      "name": "Withdrawn",
      "fields": [
        {
          "name": "user",
          "type": "publicKey"
        },
        {
          "name": "shares_burned",
          "type": "u64"
        },
        {
          "name": "amount_returned",
          "type": "u64"
        },
        {
          "name": "total_vault_shares",
          "type": "u64"
        }
      ]
    }
  ],
  "errors": [
    {
      "code": 6000,
      "name": "VaultPaused",
      "msg": "Vault is paused \u2014 emergency stop active"
    },
    {
      "code": 6001,
      "name": "ZeroAmount",
      "msg": "Amount must be greater than zero"
    },
    {
      "code": 6002,
      "name": "BelowMinDeposit",
      "msg": "Deposit below minimum threshold"
    },
    {
      "code": 6003,
      "name": "ZeroShares",
      "msg": "Calculated shares would be zero"
    },
    {
      "code": 6004,
      "name": "InsufficientShares",
      "msg": "Insufficient shares for withdrawal"
    },
    {
      "code": 6005,
      "name": "NoShareholders",
      "msg": "No shareholders in the vault"
    },
    {
      "code": 6006,
      "name": "MathOverflow",
      "msg": "Math overflow"
    },
    {
      "code": 6007,
      "name": "Unauthorized",
      "msg": "Unauthorized"
    },
    {
      "code": 6008,
      "name": "CooldownActive",
      "msg": "Withdrawal cooldown period still active"
    },
    {
      "code": 6009,
      "name": "DailyCapExceeded",
      "msg": "Daily withdrawal cap exceeded"
    },
    {
      "code": 6010,
      "name": "DestinationNotWhitelisted",
      "msg": "Withdrawal destination not in whitelist"
    },
    {
      "code": 6011,
      "name": "TooManyWhitelistEntries",
      "msg": "Too many whitelist entries (max 4)"
    },
    {
      "code": 6012,
      "name": "AgentInactive",
      "msg": "Agent is inactive"
    },
    {
      "code": 6013,
      "name": "NoTradeData",
      "msg": "No trade data available for scoring"
    },
    {
      "code": 6014,
      "name": "FeeTooHigh",
      "msg": "Agent fee exceeds maximum (30%)"
    },
    {
      "code": 6015,
      "name": "InsufficientFunds",
      "msg": "Insufficient funds in vault"
    }
  ],
  "metadata": {
    "address": "9FouWHemn9iueyHYq4qpeNj9aHMyTKfEPt8ZpJaHcZ95"
  }
}